Medición de asociación
================
JR
3 de noviembre, 2020

``` r
knitr::opts_chunk$set(fig.width=12, fig.height=8)
```

## Preámbulo

### Cargar paquetes

``` r
library(ez)
```

    ## Registered S3 methods overwritten by 'lme4':
    ##   method                          from
    ##   cooks.distance.influence.merMod car 
    ##   influence.merMod                car 
    ##   dfbeta.influence.merMod         car 
    ##   dfbetas.influence.merMod        car

``` r
library(psych)
library(vegan)
```

    ## Loading required package: permute

    ## Loading required package: lattice

    ## This is vegan 2.5-6

``` r
library(adespatial)
```

    ## Registered S3 methods overwritten by 'adegraphics':
    ##   method         from
    ##   biplot.dudi    ade4
    ##   kplot.foucart  ade4
    ##   kplot.mcoa     ade4
    ##   kplot.mfa      ade4
    ##   kplot.pta      ade4
    ##   kplot.sepan    ade4
    ##   kplot.statis   ade4
    ##   scatter.coa    ade4
    ##   scatter.dudi   ade4
    ##   scatter.nipals ade4
    ##   scatter.pco    ade4
    ##   score.acm      ade4
    ##   score.mix      ade4
    ##   score.pca      ade4
    ##   screeplot.dudi ade4

    ## Registered S3 method overwritten by 'spdep':
    ##   method   from
    ##   plot.mst ape

    ## Registered S3 methods overwritten by 'adespatial':
    ##   method             from       
    ##   plot.multispati    adegraphics
    ##   print.multispati   ade4       
    ##   summary.multispati ade4

``` r
library(broom)
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.2.1 ──

    ## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
    ## ✓ tibble  3.0.3     ✓ dplyr   0.8.3
    ## ✓ tidyr   1.0.0     ✓ stringr 1.4.0
    ## ✓ readr   1.3.1     ✓ forcats 0.4.0

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x ggplot2::%+%()   masks psych::%+%()
    ## x ggplot2::alpha() masks psych::alpha()
    ## x dplyr::filter()  masks stats::filter()
    ## x dplyr::lag()     masks stats::lag()

``` r
library(sf)
```

    ## Linking to GEOS 3.6.2, GDAL 2.2.3, PROJ 4.9.3

``` r
source('biodata/funciones.R')
```

### Cargar datos

``` r
load('biodata/matriz_ambiental.Rdata')
load('biodata/Apocynaceae-Meliaceae-Sapotaceae.Rdata')
```

## Principales categorías de medidas de asociación: modos Q y R

En modo Q mides asociación entre pares de objetos, como por ejemplo, dos
sitios de muestreo. Por lo tanto, en este caso, mides la asociación por
medio de **la disimilaridad y la similaridad** entre pares de objetos,
usando métricas como la **distancia euclídea o la similaridad de
Jaccard**.

En cambio, en modo R, mides asociación entre pares de descriptores, como
por ejemplo, dos variables, o dos especies (como variables). En este
caso mides la asociación por medio de **la dependencia entre
variables**, usando por ejemplo la **covarianza o el índice de
correlación**.

## Modo Q: matrices de disimilaridad entre objetos

### Modo Q para datos cuantitativos de especies (abundancia)

**Las matrices de disimilaridad son matrices de distancia**. La
disimilaridad (D) también la puedes obtener a partir de la similaridad
(S), aplicando la fórmula D = 1 - S, y viceversa, S = 1 - D.

#### La paradoja de Orlóci

``` r
(mc_orloci <- tibble(
  sp1 = c(0, 1, 0),
  sp2 = c(1, 0, 4),
  sp3 = c(1, 0, 8),
  sitio = paste0('sit', 1:3)) %>% 
    column_to_rownames('sitio'))
```

    ##      sp1 sp2 sp3
    ## sit1   0   1   1
    ## sit2   1   0   0
    ## sit3   0   4   8

Las matrices de distancia normalmente se muestran de la siguiente
manera:

``` r
(dist.ldc(mc_orloci, "euclidean", silent = T))
```

    ##          sit1     sit2
    ## sit2 1.732051         
    ## sit3 7.615773 9.000000

Sin embargo, para facilitar la lectura de las distancias, en esta
explicación ordeneré las matrices de distancia en columnas, usando la
función de ayuda `organizar_matriz_distancia`. La primera que generaré
es la de distancias euclideas a partir de datos brutos:

``` r
(d_euc <- dist.ldc(mc_orloci, "euclidean", silent = T) %>%
  organizar_matriz_distancia(func_dist = 'Euclidean'))
```

    ## # A tibble: 1 x 4
    ##   `Funcion de distancia` `D(sit1, sit2)` `D(sit1, sit3)` `D(sit2, sit3)`
    ##   <chr>                            <dbl>           <dbl>           <dbl>
    ## 1 Euclidean                         1.73            7.62               9

Siendo los sitios 1 y 2 tan diferentes en cuanto a las especies que los
componen (no comparten especies de hecho), ¿por qué están tan próximos?
Asimismo, los sitios 1 y 3 comparten especies, entonces, ¿por qué están
tan distantes (=disímiles)? La explicación se atribuye a los ceros y a
los valores de abundancia extremos. El hecho de que un par de sitios
registren varias ausencias (o pseudo-ausencias), hace que “aparezcan”
muy próximos (similares) en el espacio euclídeo. Esta paradoja sugiere
que es necesario evitar la distancia euclídea a partir de datos brutos
como métrica para comparar sitios.

Existen distintas maneras de solucionar este problema, normalmente
recurriendo a métodos de estandarización de los datos brutos de la
matriz de comunidad, y luego calculando distancia euclídea. Es decir, se
obtiene una matriz transformada y a partir de ella se obtienen
distancias. Los más comunes son el método de cuerdas (*chord*),
*ji*-cuadrado y *Hellinger*. La función `dist.ldc` del paquete
`adespatial` provee una solución en un único paso para cada caso.

  - *Chord*:

<!-- end list -->

``` r
d_cho <- dist.ldc(mc_orloci, "chord", silent = T) %>%
  organizar_matriz_distancia(func_dist = 'Chord')
```

  - *Ji*-cuadrado:

<!-- end list -->

``` r
d_chi <- dist.ldc(mc_orloci, "chisquare", silent = T) %>%
  organizar_matriz_distancia(func_dist = 'chi-square distance')
```

  - *Hellinger* (valores primero divididos por abundancia total \> sqrt)

<!-- end list -->

``` r
d_hel <- dist.ldc(mc_orloci, "hellinger", silent = T) %>%
  organizar_matriz_distancia(func_dist = 'Hellinger')
```

  - Uniendo y comparando

<!-- end list -->

``` r
(d_todas <- bind_rows(d_euc, d_cho, d_chi, d_hel))
```

    ## # A tibble: 4 x 4
    ##   `Funcion de distancia` `D(sit1, sit2)` `D(sit1, sit3)` `D(sit2, sit3)`
    ##   <chr>                            <dbl>           <dbl>           <dbl>
    ## 1 Euclidean                         1.73           7.62             9   
    ## 2 Chord                             1.41           0.320            1.41
    ## 3 chi-square distance               4.02           0.360            4.01
    ## 4 Hellinger                         1.41           0.170            1.41

``` r
mc_orloci
```

    ##      sp1 sp2 sp3
    ## sit1   0   1   1
    ## sit2   1   0   0
    ## sit3   0   4   8

Ahora observa cómo se calcula *chord* en dos pasos:

  - Primero construye matriz de comunidad estandarizada, obtenida a
    partir del cuadrado de cada valor y luego dividido (estandarizando)
    por la suma de los cuadrados de toda la fila o sitio (vector
    unitario). El resultado final, es decir, la matriz con valores
    transformados, se obtiene a partir de la raíz cuadrada de cada
    valor.

<!-- end list -->

``` r
(mc_orloci_norm <- sqrt(mc_orloci^2/rowSums(mc_orloci^2)))
```

    ##      sp1       sp2       sp3
    ## sit1   0 0.7071068 0.7071068
    ## sit2   1 0.0000000 0.0000000
    ## sit3   0 0.4472136 0.8944272

La matriz de comunidad se dice que está “normalizada”. Lo anterior se
puede hacer más fácilmente con `decostand` de `vegan`:

``` r
(mc_orloci_norm <- decostand(mc_orloci, "normalize"))
```

    ##      sp1       sp2       sp3
    ## sit1   0 0.7071068 0.7071068
    ## sit2   1 0.0000000 0.0000000
    ## sit3   0 0.4472136 0.8944272

  - Luego, se obtiene la distancia euclidea:

<!-- end list -->

``` r
(d_cho_2_pasos <- dist(mc_orloci_norm, method = 'euclidean')) %>% 
  organizar_matriz_distancia(func_dist = 'Chord en dos pasos')
```

    ## # A tibble: 1 x 4
    ##   `Funcion de distancia` `D(sit1, sit2)` `D(sit1, sit3)` `D(sit2, sit3)`
    ##   <chr>                            <dbl>           <dbl>           <dbl>
    ## 1 Chord en dos pasos                1.41           0.320            1.41

``` r
d_cho #Compara
```

    ## # A tibble: 1 x 4
    ##   `Funcion de distancia` `D(sit1, sit2)` `D(sit1, sit3)` `D(sit2, sit3)`
    ##   <chr>                            <dbl>           <dbl>           <dbl>
    ## 1 Chord                             1.41           0.320            1.41

Aplicado a BCI y mi familia (en forma de matriz de distncia), utilizando
la transformación *Hellinger*:

``` r
mi_fam_d_hel <- dist.ldc(mc_apcyn_melic_saptc, "hellinger", silent = T)
```

Para interpretar esta matriz, es necesario representarla esta matriz
gráficamente:

``` r
coldiss(mi_fam_d_hel)
```

    ## Loading required package: gclus

    ## Loading required package: cluster

    ## Registered S3 method overwritten by 'gclus':
    ##   method         from 
    ##   reorder.hclust vegan

![](medicion_asociacion_1_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->

Guardo el gráfico. Puedes usar el botón `Export` de la pestaña `Plots`

La calidad de gráficos exigida en revistas, suele requerir usar
funciones específicas para guardar gráficos. Por ejemplo

``` r
png(
  filename = 'matriz_disimilaridad_hellinger.png',
  width = 2400, height = 1200, pointsize = 32
)
coldiss(mi_fam_d_hel)
dev.off()
```

    ## png 
    ##   2

MUY IMPORTANTE. La última función, `dev.off()`, es necesaria para cerrar
el dispositivo. Si no la ejecutas, no se generarán gráficos en el
dispositivo estándar (pestaña
    `Plots`)

## Modo Q para datos binarios

``` r
vegdist(mc_apcyn_melic_saptc, method = 'jac', binary = T)
```

    ##             1          2          3          4          5          6
    ## 2  0.08333333                                                       
    ## 3  0.15384615 0.23076923                                            
    ## 4  0.15384615 0.23076923 0.00000000                                 
    ## 5  0.26666667 0.33333333 0.26666667 0.26666667                      
    ## 6  0.23076923 0.30769231 0.08333333 0.08333333 0.21428571           
    ## 7  0.23076923 0.30769231 0.23076923 0.23076923 0.33333333 0.30769231
    ## 8  0.23076923 0.30769231 0.08333333 0.08333333 0.21428571 0.00000000
    ## 9  0.23076923 0.30769231 0.08333333 0.08333333 0.21428571 0.00000000
    ## 10 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 11 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 12 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 13 0.30769231 0.38461538 0.16666667 0.16666667 0.40000000 0.25000000
    ## 14 0.07692308 0.15384615 0.07692308 0.07692308 0.20000000 0.15384615
    ## 15 0.15384615 0.23076923 0.15384615 0.15384615 0.26666667 0.23076923
    ## 16 0.23076923 0.16666667 0.08333333 0.08333333 0.33333333 0.16666667
    ## 17 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 18 0.15384615 0.23076923 0.15384615 0.15384615 0.26666667 0.23076923
    ## 19 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 20 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 21 0.15384615 0.23076923 0.15384615 0.15384615 0.26666667 0.23076923
    ## 22 0.23076923 0.16666667 0.23076923 0.23076923 0.33333333 0.30769231
    ## 23 0.07692308 0.15384615 0.21428571 0.21428571 0.20000000 0.28571429
    ## 24 0.23076923 0.16666667 0.23076923 0.23076923 0.33333333 0.30769231
    ## 25 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 26 0.33333333 0.27272727 0.33333333 0.33333333 0.42857143 0.27272727
    ## 27 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 28 0.21428571 0.28571429 0.07692308 0.07692308 0.20000000 0.15384615
    ## 29 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 30 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 31 0.16666667 0.09090909 0.16666667 0.16666667 0.40000000 0.25000000
    ## 32 0.28571429 0.35714286 0.15384615 0.15384615 0.26666667 0.23076923
    ## 33 0.15384615 0.23076923 0.00000000 0.00000000 0.26666667 0.08333333
    ## 34 0.23076923 0.30769231 0.23076923 0.23076923 0.33333333 0.30769231
    ## 35 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 36 0.23076923 0.30769231 0.23076923 0.23076923 0.21428571 0.16666667
    ## 37 0.23076923 0.16666667 0.23076923 0.23076923 0.33333333 0.30769231
    ## 38 0.08333333 0.16666667 0.08333333 0.08333333 0.33333333 0.16666667
    ## 39 0.08333333 0.16666667 0.08333333 0.08333333 0.33333333 0.16666667
    ## 40 0.08333333 0.16666667 0.08333333 0.08333333 0.33333333 0.16666667
    ## 41 0.00000000 0.08333333 0.15384615 0.15384615 0.26666667 0.23076923
    ## 42 0.07692308 0.15384615 0.07692308 0.07692308 0.20000000 0.15384615
    ## 43 0.16666667 0.25000000 0.16666667 0.16666667 0.40000000 0.25000000
    ## 44 0.21428571 0.28571429 0.21428571 0.21428571 0.31250000 0.28571429
    ## 45 0.30769231 0.25000000 0.16666667 0.16666667 0.40000000 0.25000000
    ## 46 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 47 0.23076923 0.30769231 0.08333333 0.08333333 0.33333333 0.16666667
    ## 48 0.00000000 0.08333333 0.15384615 0.15384615 0.26666667 0.23076923
    ## 49 0.30769231 0.25000000 0.16666667 0.16666667 0.40000000 0.25000000
    ## 50 0.00000000 0.08333333 0.15384615 0.15384615 0.26666667 0.23076923
    ##             7          8          9         10         11         12
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8  0.30769231                                                       
    ## 9  0.30769231 0.00000000                                            
    ## 10 0.16666667 0.16666667 0.16666667                                 
    ## 11 0.23076923 0.08333333 0.08333333 0.08333333                      
    ## 12 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000           
    ## 13 0.09090909 0.25000000 0.25000000 0.09090909 0.16666667 0.16666667
    ## 14 0.15384615 0.15384615 0.15384615 0.15384615 0.07692308 0.07692308
    ## 15 0.35714286 0.23076923 0.23076923 0.23076923 0.15384615 0.15384615
    ## 16 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 17 0.16666667 0.16666667 0.16666667 0.00000000 0.08333333 0.08333333
    ## 18 0.08333333 0.23076923 0.23076923 0.08333333 0.15384615 0.15384615
    ## 19 0.16666667 0.16666667 0.16666667 0.00000000 0.08333333 0.08333333
    ## 20 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.00000000
    ## 21 0.35714286 0.23076923 0.23076923 0.23076923 0.15384615 0.15384615
    ## 22 0.42857143 0.30769231 0.30769231 0.30769231 0.23076923 0.23076923
    ## 23 0.28571429 0.28571429 0.28571429 0.28571429 0.21428571 0.21428571
    ## 24 0.42857143 0.30769231 0.30769231 0.30769231 0.23076923 0.23076923
    ## 25 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.00000000
    ## 26 0.41666667 0.27272727 0.27272727 0.27272727 0.33333333 0.33333333
    ## 27 0.16666667 0.16666667 0.16666667 0.00000000 0.08333333 0.08333333
    ## 28 0.28571429 0.15384615 0.15384615 0.15384615 0.07692308 0.07692308
    ## 29 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.00000000
    ## 30 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.00000000
    ## 31 0.38461538 0.25000000 0.25000000 0.25000000 0.16666667 0.16666667
    ## 32 0.23076923 0.23076923 0.23076923 0.08333333 0.15384615 0.15384615
    ## 33 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.00000000
    ## 34 0.30769231 0.30769231 0.30769231 0.16666667 0.23076923 0.23076923
    ## 35 0.16666667 0.16666667 0.16666667 0.00000000 0.08333333 0.08333333
    ## 36 0.42857143 0.16666667 0.16666667 0.30769231 0.23076923 0.23076923
    ## 37 0.42857143 0.30769231 0.30769231 0.30769231 0.23076923 0.23076923
    ## 38 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 39 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 40 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 41 0.23076923 0.23076923 0.23076923 0.23076923 0.15384615 0.15384615
    ## 42 0.15384615 0.15384615 0.15384615 0.15384615 0.07692308 0.07692308
    ## 43 0.25000000 0.25000000 0.25000000 0.09090909 0.16666667 0.16666667
    ## 44 0.15384615 0.28571429 0.28571429 0.15384615 0.21428571 0.21428571
    ## 45 0.25000000 0.25000000 0.25000000 0.09090909 0.16666667 0.16666667
    ## 46 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 47 0.30769231 0.16666667 0.16666667 0.16666667 0.08333333 0.08333333
    ## 48 0.23076923 0.23076923 0.23076923 0.23076923 0.15384615 0.15384615
    ## 49 0.25000000 0.25000000 0.25000000 0.09090909 0.16666667 0.16666667
    ## 50 0.23076923 0.23076923 0.23076923 0.23076923 0.15384615 0.15384615
    ##            13         14         15         16         17         18
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14 0.23076923                                                       
    ## 15 0.30769231 0.21428571                                            
    ## 16 0.25000000 0.15384615 0.23076923                                 
    ## 17 0.09090909 0.15384615 0.23076923 0.16666667                      
    ## 18 0.16666667 0.07692308 0.28571429 0.23076923 0.08333333           
    ## 19 0.09090909 0.15384615 0.23076923 0.16666667 0.00000000 0.08333333
    ## 20 0.16666667 0.07692308 0.15384615 0.08333333 0.08333333 0.15384615
    ## 21 0.30769231 0.21428571 0.15384615 0.23076923 0.23076923 0.28571429
    ## 22 0.38461538 0.28571429 0.08333333 0.16666667 0.30769231 0.35714286
    ## 23 0.35714286 0.14285714 0.07692308 0.28571429 0.28571429 0.21428571
    ## 24 0.38461538 0.28571429 0.23076923 0.16666667 0.30769231 0.35714286
    ## 25 0.16666667 0.07692308 0.15384615 0.08333333 0.08333333 0.15384615
    ## 26 0.36363636 0.38461538 0.33333333 0.27272727 0.27272727 0.33333333
    ## 27 0.09090909 0.15384615 0.23076923 0.16666667 0.00000000 0.08333333
    ## 28 0.23076923 0.14285714 0.07692308 0.15384615 0.15384615 0.21428571
    ## 29 0.16666667 0.07692308 0.15384615 0.08333333 0.08333333 0.15384615
    ## 30 0.16666667 0.07692308 0.15384615 0.08333333 0.08333333 0.15384615
    ## 31 0.33333333 0.23076923 0.16666667 0.09090909 0.25000000 0.30769231
    ## 32 0.16666667 0.21428571 0.15384615 0.23076923 0.08333333 0.15384615
    ## 33 0.16666667 0.07692308 0.15384615 0.08333333 0.08333333 0.15384615
    ## 34 0.25000000 0.28571429 0.08333333 0.30769231 0.16666667 0.23076923
    ## 35 0.09090909 0.15384615 0.23076923 0.16666667 0.00000000 0.08333333
    ## 36 0.38461538 0.28571429 0.08333333 0.30769231 0.30769231 0.35714286
    ## 37 0.38461538 0.28571429 0.08333333 0.16666667 0.30769231 0.35714286
    ## 38 0.25000000 0.15384615 0.08333333 0.16666667 0.16666667 0.23076923
    ## 39 0.25000000 0.15384615 0.08333333 0.16666667 0.16666667 0.23076923
    ## 40 0.25000000 0.15384615 0.08333333 0.16666667 0.16666667 0.23076923
    ## 41 0.30769231 0.07692308 0.15384615 0.23076923 0.23076923 0.15384615
    ## 42 0.23076923 0.00000000 0.21428571 0.15384615 0.15384615 0.07692308
    ## 43 0.18181818 0.23076923 0.16666667 0.25000000 0.09090909 0.16666667
    ## 44 0.23076923 0.14285714 0.33333333 0.28571429 0.15384615 0.07692308
    ## 45 0.18181818 0.23076923 0.30769231 0.09090909 0.09090909 0.16666667
    ## 46 0.25000000 0.15384615 0.23076923 0.16666667 0.16666667 0.23076923
    ## 47 0.25000000 0.15384615 0.23076923 0.16666667 0.16666667 0.23076923
    ## 48 0.30769231 0.07692308 0.15384615 0.23076923 0.23076923 0.15384615
    ## 49 0.18181818 0.23076923 0.30769231 0.09090909 0.09090909 0.16666667
    ## 50 0.30769231 0.07692308 0.15384615 0.23076923 0.23076923 0.15384615
    ##            19         20         21         22         23         24
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14                                                                  
    ## 15                                                                  
    ## 16                                                                  
    ## 17                                                                  
    ## 18                                                                  
    ## 19                                                                  
    ## 20 0.08333333                                                       
    ## 21 0.23076923 0.15384615                                            
    ## 22 0.30769231 0.23076923 0.23076923                                 
    ## 23 0.28571429 0.21428571 0.21428571 0.15384615                      
    ## 24 0.30769231 0.23076923 0.08333333 0.16666667 0.28571429           
    ## 25 0.08333333 0.00000000 0.15384615 0.23076923 0.21428571 0.23076923
    ## 26 0.27272727 0.33333333 0.33333333 0.27272727 0.38461538 0.27272727
    ## 27 0.00000000 0.08333333 0.23076923 0.30769231 0.28571429 0.30769231
    ## 28 0.15384615 0.07692308 0.21428571 0.15384615 0.14285714 0.28571429
    ## 29 0.08333333 0.00000000 0.15384615 0.23076923 0.21428571 0.23076923
    ## 30 0.08333333 0.00000000 0.15384615 0.23076923 0.21428571 0.23076923
    ## 31 0.25000000 0.16666667 0.16666667 0.09090909 0.23076923 0.09090909
    ## 32 0.08333333 0.15384615 0.28571429 0.23076923 0.21428571 0.35714286
    ## 33 0.08333333 0.00000000 0.15384615 0.23076923 0.21428571 0.23076923
    ## 34 0.16666667 0.23076923 0.23076923 0.16666667 0.15384615 0.30769231
    ## 35 0.00000000 0.08333333 0.23076923 0.30769231 0.28571429 0.30769231
    ## 36 0.30769231 0.23076923 0.23076923 0.16666667 0.15384615 0.30769231
    ## 37 0.30769231 0.23076923 0.23076923 0.00000000 0.15384615 0.16666667
    ## 38 0.16666667 0.08333333 0.08333333 0.16666667 0.15384615 0.16666667
    ## 39 0.16666667 0.08333333 0.08333333 0.16666667 0.15384615 0.16666667
    ## 40 0.16666667 0.08333333 0.08333333 0.16666667 0.15384615 0.16666667
    ## 41 0.23076923 0.15384615 0.15384615 0.23076923 0.07692308 0.23076923
    ## 42 0.15384615 0.07692308 0.21428571 0.28571429 0.14285714 0.28571429
    ## 43 0.09090909 0.16666667 0.16666667 0.25000000 0.23076923 0.25000000
    ## 44 0.15384615 0.21428571 0.33333333 0.40000000 0.26666667 0.40000000
    ## 45 0.09090909 0.16666667 0.30769231 0.25000000 0.35714286 0.25000000
    ## 46 0.16666667 0.08333333 0.23076923 0.30769231 0.28571429 0.30769231
    ## 47 0.16666667 0.08333333 0.23076923 0.30769231 0.28571429 0.30769231
    ## 48 0.23076923 0.15384615 0.15384615 0.23076923 0.07692308 0.23076923
    ## 49 0.09090909 0.16666667 0.30769231 0.25000000 0.35714286 0.25000000
    ## 50 0.23076923 0.15384615 0.15384615 0.23076923 0.07692308 0.23076923
    ##            25         26         27         28         29         30
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14                                                                  
    ## 15                                                                  
    ## 16                                                                  
    ## 17                                                                  
    ## 18                                                                  
    ## 19                                                                  
    ## 20                                                                  
    ## 21                                                                  
    ## 22                                                                  
    ## 23                                                                  
    ## 24                                                                  
    ## 25                                                                  
    ## 26 0.33333333                                                       
    ## 27 0.08333333 0.27272727                                            
    ## 28 0.07692308 0.38461538 0.15384615                                 
    ## 29 0.00000000 0.33333333 0.08333333 0.07692308                      
    ## 30 0.00000000 0.33333333 0.08333333 0.07692308 0.00000000           
    ## 31 0.16666667 0.20000000 0.25000000 0.23076923 0.16666667 0.16666667
    ## 32 0.15384615 0.33333333 0.08333333 0.07692308 0.15384615 0.15384615
    ## 33 0.00000000 0.33333333 0.08333333 0.07692308 0.00000000 0.00000000
    ## 34 0.23076923 0.27272727 0.16666667 0.15384615 0.23076923 0.23076923
    ## 35 0.08333333 0.27272727 0.00000000 0.15384615 0.08333333 0.08333333
    ## 36 0.23076923 0.27272727 0.30769231 0.15384615 0.23076923 0.23076923
    ## 37 0.23076923 0.27272727 0.30769231 0.15384615 0.23076923 0.23076923
    ## 38 0.08333333 0.27272727 0.16666667 0.15384615 0.08333333 0.08333333
    ## 39 0.08333333 0.27272727 0.16666667 0.15384615 0.08333333 0.08333333
    ## 40 0.08333333 0.27272727 0.16666667 0.15384615 0.08333333 0.08333333
    ## 41 0.15384615 0.33333333 0.23076923 0.21428571 0.15384615 0.15384615
    ## 42 0.07692308 0.38461538 0.15384615 0.14285714 0.07692308 0.07692308
    ## 43 0.16666667 0.20000000 0.09090909 0.23076923 0.16666667 0.16666667
    ## 44 0.21428571 0.38461538 0.15384615 0.26666667 0.21428571 0.21428571
    ## 45 0.16666667 0.20000000 0.09090909 0.23076923 0.16666667 0.16666667
    ## 46 0.08333333 0.41666667 0.16666667 0.15384615 0.08333333 0.08333333
    ## 47 0.08333333 0.41666667 0.16666667 0.15384615 0.08333333 0.08333333
    ## 48 0.15384615 0.33333333 0.23076923 0.21428571 0.15384615 0.15384615
    ## 49 0.16666667 0.20000000 0.09090909 0.23076923 0.16666667 0.16666667
    ## 50 0.15384615 0.33333333 0.23076923 0.21428571 0.15384615 0.15384615
    ##            31         32         33         34         35         36
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14                                                                  
    ## 15                                                                  
    ## 16                                                                  
    ## 17                                                                  
    ## 18                                                                  
    ## 19                                                                  
    ## 20                                                                  
    ## 21                                                                  
    ## 22                                                                  
    ## 23                                                                  
    ## 24                                                                  
    ## 25                                                                  
    ## 26                                                                  
    ## 27                                                                  
    ## 28                                                                  
    ## 29                                                                  
    ## 30                                                                  
    ## 31                                                                  
    ## 32 0.30769231                                                       
    ## 33 0.16666667 0.15384615                                            
    ## 34 0.25000000 0.08333333 0.23076923                                 
    ## 35 0.25000000 0.08333333 0.08333333 0.16666667                      
    ## 36 0.25000000 0.23076923 0.23076923 0.16666667 0.30769231           
    ## 37 0.09090909 0.23076923 0.23076923 0.16666667 0.30769231 0.16666667
    ## 38 0.09090909 0.23076923 0.08333333 0.16666667 0.16666667 0.16666667
    ## 39 0.09090909 0.23076923 0.08333333 0.16666667 0.16666667 0.16666667
    ## 40 0.09090909 0.23076923 0.08333333 0.16666667 0.16666667 0.16666667
    ## 41 0.16666667 0.28571429 0.15384615 0.23076923 0.23076923 0.23076923
    ## 42 0.23076923 0.21428571 0.07692308 0.28571429 0.15384615 0.28571429
    ## 43 0.18181818 0.16666667 0.16666667 0.09090909 0.09090909 0.25000000
    ## 44 0.35714286 0.21428571 0.21428571 0.28571429 0.15384615 0.40000000
    ## 45 0.18181818 0.16666667 0.16666667 0.25000000 0.09090909 0.38461538
    ## 46 0.25000000 0.23076923 0.08333333 0.30769231 0.16666667 0.30769231
    ## 47 0.25000000 0.23076923 0.08333333 0.30769231 0.16666667 0.30769231
    ## 48 0.16666667 0.28571429 0.15384615 0.23076923 0.23076923 0.23076923
    ## 49 0.18181818 0.16666667 0.16666667 0.25000000 0.09090909 0.38461538
    ## 50 0.16666667 0.28571429 0.15384615 0.23076923 0.23076923 0.23076923
    ##            37         38         39         40         41         42
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14                                                                  
    ## 15                                                                  
    ## 16                                                                  
    ## 17                                                                  
    ## 18                                                                  
    ## 19                                                                  
    ## 20                                                                  
    ## 21                                                                  
    ## 22                                                                  
    ## 23                                                                  
    ## 24                                                                  
    ## 25                                                                  
    ## 26                                                                  
    ## 27                                                                  
    ## 28                                                                  
    ## 29                                                                  
    ## 30                                                                  
    ## 31                                                                  
    ## 32                                                                  
    ## 33                                                                  
    ## 34                                                                  
    ## 35                                                                  
    ## 36                                                                  
    ## 37                                                                  
    ## 38 0.16666667                                                       
    ## 39 0.16666667 0.00000000                                            
    ## 40 0.16666667 0.00000000 0.00000000                                 
    ## 41 0.23076923 0.08333333 0.08333333 0.08333333                      
    ## 42 0.28571429 0.15384615 0.15384615 0.15384615 0.07692308           
    ## 43 0.25000000 0.09090909 0.09090909 0.09090909 0.16666667 0.23076923
    ## 44 0.40000000 0.28571429 0.28571429 0.28571429 0.21428571 0.14285714
    ## 45 0.25000000 0.25000000 0.25000000 0.25000000 0.30769231 0.23076923
    ## 46 0.30769231 0.16666667 0.16666667 0.16666667 0.23076923 0.15384615
    ## 47 0.30769231 0.16666667 0.16666667 0.16666667 0.23076923 0.15384615
    ## 48 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.07692308
    ## 49 0.25000000 0.25000000 0.25000000 0.25000000 0.30769231 0.23076923
    ## 50 0.23076923 0.08333333 0.08333333 0.08333333 0.00000000 0.07692308
    ##            43         44         45         46         47         48
    ## 2                                                                   
    ## 3                                                                   
    ## 4                                                                   
    ## 5                                                                   
    ## 6                                                                   
    ## 7                                                                   
    ## 8                                                                   
    ## 9                                                                   
    ## 10                                                                  
    ## 11                                                                  
    ## 12                                                                  
    ## 13                                                                  
    ## 14                                                                  
    ## 15                                                                  
    ## 16                                                                  
    ## 17                                                                  
    ## 18                                                                  
    ## 19                                                                  
    ## 20                                                                  
    ## 21                                                                  
    ## 22                                                                  
    ## 23                                                                  
    ## 24                                                                  
    ## 25                                                                  
    ## 26                                                                  
    ## 27                                                                  
    ## 28                                                                  
    ## 29                                                                  
    ## 30                                                                  
    ## 31                                                                  
    ## 32                                                                  
    ## 33                                                                  
    ## 34                                                                  
    ## 35                                                                  
    ## 36                                                                  
    ## 37                                                                  
    ## 38                                                                  
    ## 39                                                                  
    ## 40                                                                  
    ## 41                                                                  
    ## 42                                                                  
    ## 43                                                                  
    ## 44 0.23076923                                                       
    ## 45 0.18181818 0.23076923                                            
    ## 46 0.25000000 0.28571429 0.25000000                                 
    ## 47 0.25000000 0.28571429 0.25000000 0.00000000                      
    ## 48 0.16666667 0.21428571 0.30769231 0.23076923 0.23076923           
    ## 49 0.18181818 0.23076923 0.00000000 0.25000000 0.25000000 0.30769231
    ## 50 0.16666667 0.21428571 0.30769231 0.23076923 0.23076923 0.00000000
    ##            49
    ## 2            
    ## 3            
    ## 4            
    ## 5            
    ## 6            
    ## 7            
    ## 8            
    ## 9            
    ## 10           
    ## 11           
    ## 12           
    ## 13           
    ## 14           
    ## 15           
    ## 16           
    ## 17           
    ## 18           
    ## 19           
    ## 20           
    ## 21           
    ## 22           
    ## 23           
    ## 24           
    ## 25           
    ## 26           
    ## 27           
    ## 28           
    ## 29           
    ## 30           
    ## 31           
    ## 32           
    ## 33           
    ## 34           
    ## 35           
    ## 36           
    ## 37           
    ## 38           
    ## 39           
    ## 40           
    ## 41           
    ## 42           
    ## 43           
    ## 44           
    ## 45           
    ## 46           
    ## 47           
    ## 48           
    ## 49           
    ## 50 0.30769231

`binary=T` realiza primero `decostand(mc_apcyn_melic_saptc, method =
'pa')`

``` r
head(mc_apcyn_melic_saptc)
```

    ##   Aspidosperma spruceanum Cedrela odorata Chrysophyllum argenteum
    ## 1                       3               0                      21
    ## 2                       2               0                      11
    ## 3                       2               0                      19
    ## 4                       3               0                      38
    ## 5                       2               1                      21
    ## 6                       3               0                      18
    ##   Chrysophyllum cainito Guarea bullata Guarea grandifolia Guarea guidonia
    ## 1                     2             24                  4              37
    ## 2                     1             20                  2              33
    ## 3                     1             15                  2              20
    ## 4                     2             19                  1              21
    ## 5                     0             24                  1              21
    ## 6                     0             12                  1              15
    ##   Lacmellea panamensis Pouteria fossicola Pouteria reticulata
    ## 1                    2                  0                  12
    ## 2                    0                  0                  23
    ## 3                    3                  0                  29
    ## 4                    3                  0                  18
    ## 5                    3                  1                  16
    ## 6                    3                  0                  19
    ##   Pouteria stipitata Rauvolfia littoralis Tabernaemontana arborea
    ## 1                  0                    0                      37
    ## 2                  0                    0                      37
    ## 3                  1                    0                      51
    ## 4                  4                    0                      48
    ## 5                  1                    0                      41
    ## 6                  2                    0                      43
    ##   Thevetia ahouai Trichilia pallida Trichilia tuberculata
    ## 1               6                 2                   159
    ## 2               1                 6                   177
    ## 3               0                 5                    67
    ## 4               0                 8                    72
    ## 5               2                 7                    47
    ## 6               0                 2                    75

### Asociación entre especies

``` r
mc_apcyn_melic_saptc_t <- t(mc_apcyn_melic_saptc)
mc_apcyn_melic_saptc_t_chi <- decostand(mc_apcyn_melic_saptc_t, "chi.square")
mc_apcyn_melic_saptc_t_chi_euc <- dist(mc_apcyn_melic_saptc_t_chi)
coldiss(mc_apcyn_melic_saptc_t_chi_euc, diag = TRUE)
```

![](medicion_asociacion_1_files/figure-gfm/unnamed-chunk-19-1.png)<!-- -->

### Riqueza capturada según estimadores

``` r
specpool(mc_apcyn_melic_saptc)
```

    ##     Species chao   chao.se jack1 jack1.se jack2     boot   boot.se  n
    ## All      16   16 0.4744405 16.98     0.98 17.94 16.40955 0.5222938 50

``` r
specpool(mc_apcyn_melic_saptc)[[1]]/specpool(mc_apcyn_melic_saptc)*100
```

    ##     Species chao  chao.se   jack1 jack1.se    jack2     boot boot.se  n
    ## All     100  100 3372.394 94.2285 1632.653 89.18618 97.50419 3063.41 32

``` r
#SCBD (species contribution to beta diversity) y LCBD (local contribution...)
mc_apcyn_melic_saptc_beta <- beta.div(mc_apcyn_melic_saptc, method = "hellinger", nperm = 9999)
mc_apcyn_melic_saptc_beta$SCBD[mc_apcyn_melic_saptc_beta$SCBD >= mean(mc_apcyn_melic_saptc_beta$SCBD)]
```

    ## Aspidosperma spruceanum Chrysophyllum argenteum Tabernaemontana arborea 
    ##              0.10336750              0.08390112              0.18324198 
    ##         Thevetia ahouai       Trichilia pallida   Trichilia tuberculata 
    ##              0.06550421              0.07780499              0.16802462

``` r
row.names(mc_apcyn_melic_saptc[which(mc_apcyn_melic_saptc_beta$p.LCBD <= 0.05),])
```

    ## [1] "5"  "18"

``` r
#
```
